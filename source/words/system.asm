; ******************************************************************************
; ******************************************************************************
;
;		Name : 		system.asm
;		Purpose : 	System Commands
;		Author : 	Paul Robson (paul@robsons.org.uk)
;		Created : 	13th November 2019
;
; ******************************************************************************
; ******************************************************************************

; ******************************************************************************
;
;							 NEW erase program
;
; ******************************************************************************

Command_New: ;; [new]
		StartCommand
		stz 	ProgramStart
		jmp 	WarmStart
		
; ******************************************************************************
;
;								END program
;
; ******************************************************************************

Command_End: ;; [end]
		StartCommand
		jmp 	WarmStart

; ******************************************************************************
;
;							  STOP with error
;
; ******************************************************************************

Command_Stop: ;; [stop]
		.byte 	$FF
		StartCommand
		rerror 	"STOP"

; ******************************************************************************
;
;								ASSERT
;
; ******************************************************************************

Command_Assert: ;; [assert]
		StartCommand
		lda 	lowStack,x 					; check TOS = 0 ?
		ora 	highStack,x
		beq 	_CAFail
		dex 								; throw if not.
		NextCommand
_CAFail:
		rerror 	"ASSERT"
